<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Universal Pure Desk - ‡∏û‡∏≤‡∏£‡∏ß‡∏µ‡∏£‡πå</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { background: #000; height: 100%; width: 100%; overflow: hidden; position: fixed; font-family: sans-serif; color: #fff; }
        .half { height: 50%; display: flex; flex-direction: column; position: relative; border-bottom: 1px solid #222; }
        .top { transform: rotate(180deg); }
        
        /* ‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ */
        .controls { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-between; padding: 0 10px; z-index: 100; }
        select { background: #222; color: #fff; border: 1px solid #444; font-size: 12px; border-radius: 4px; padding: 2px; }
        .mute-btn { background: #222; border: 1px solid #444; color: #888; border-radius: 4px; padding: 2px 8px; cursor: pointer; }
        .mute-btn.active { color: #ff4444; border-color: #ff4444; }

        .stage { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; padding: 10px; }
        .mic-btn { width: 100px; height: 100px; background: #111; border: 3px solid #333; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #888; cursor: pointer; transition: 0.2s; }
        .mic-btn span { font-size: 10px; font-weight: bold; margin-top: 5px; }
        .listening .mic-btn { border-color: #ff4444; color: #ff4444; box-shadow: 0 0 20px rgba(255,68,68,0.3); }

        .display-box { font-size: 8vw; font-weight: 900; line-height: 1.2; text-align: center; width: 100%; max-height: 80%; overflow-y: auto; display: none; padding: 20px; word-break: break-word; }
        .has-msg .mic-btn { display: none; }
        .has-msg .display-box { display: block; }

        .buffer-row { height: 60px; background: #0a0a0a; border-top: 1px solid #222; display: flex; align-items: center; gap: 8px; padding: 0 10px; flex-shrink: 0; }
        .buffer-input { flex: 1; background: #000; border: 1px solid #333; border-radius: 8px; padding: 10px; font-size: 16px; color: #0f0; outline: none; overflow-x: auto; white-space: nowrap; }
        .btn-sm { background: #222; color: #888; border: 1px solid #444; padding: 5px; border-radius: 4px; font-size: 10px; font-weight: bold; }
        .send-btn { width: 45px; height: 45px; background: #fff; color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; border: none; font-weight: bold; }
    </style>
</head>
<body>

    <div class="half top" id="top-half">
        <div class="controls">
            <select id="top-lang"></select>
            <div class="mute-btn" id="top-mute" onclick="toggleMute('top')">üîä</div>
        </div>
        <div class="stage" onclick="clearMsg('top')">
            <div class="mic-btn" id="top-mic">üéôÔ∏è<span>HOLD</span></div>
            <div class="display-box" id="top-display"></div>
        </div>
        <div class="buffer-row">
            <div class="buffer-input" id="top-buffer" contenteditable="true"></div>
            <div class="btn-sm" onclick="clearBuf('top')">CLR</div>
            <div class="send-btn" onclick="send('top')">‚ûî</div>
        </div>
    </div>

    <div class="half bottom" id="bottom-half">
        <div class="controls">
            <select id="bottom-lang"></select>
            <div class="mute-btn" id="bottom-mute" onclick="toggleMute('bottom')">üîä</div>
        </div>
        <div class="stage" onclick="clearMsg('bottom')">
            <div class="mic-btn" id="bottom-mic">üéôÔ∏è<span>‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á</span></div>
            <div class="display-box" id="bottom-display"></div>
        </div>
        <div class="buffer-row">
            <div class="buffer-input" id="bottom-buffer" contenteditable="true"></div>
            <div class="btn-sm" onclick="clearBuf('bottom')">CLR</div>
            <div class="send-btn" onclick="send('bottom')">‚ûî</div>
        </div>
    </div>

    <script>
        const langs = {
            "th-TH":"Thai","en-US":"English","no-NO":"Norwegian","sv-SE":"Swedish","de-DE":"German","ja-JP":"Japanese",
            "ko-KR":"Korean","zh-CN":"Chinese","fr-FR":"French","ru-RU":"Russian","it-IT":"Italian","es-ES":"Spanish",
            "pt-PT":"Portuguese","vi-VN":"Vietnamese","ar-SA":"Arabic","hi-IN":"Hindi"
        };
        let muteState = { top: false, bottom: false };
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.continuous = true; recognition.interimResults = true;
        const synth = window.speechSynthesis;
        let activeSide = null;

        function init() {
            ['top', 'bottom'].forEach(side => {
                const sel = document.getElementById(side + '-lang');
                Object.keys(langs).forEach(k => { const opt = new Option(langs[k], k); sel.add(opt); });
                if(side==='bottom') sel.value = 'th-TH'; else sel.value = 'en-US';
                
                const btn = document.getElementById(side + '-mic');
                const start = (e) => { e.preventDefault(); activeSide = side; recognition.lang = sel.value; document.getElementById(side+'-half').classList.add('listening'); try { recognition.start(); } catch(err){} };
                const stop = (e) => { e.preventDefault(); recognition.stop(); document.getElementById(side+'-half').classList.remove('listening'); };
                btn.addEventListener('touchstart', start); btn.addEventListener('touchend', stop);
            });
        }

        recognition.onresult = (e) => {
            let t = ""; for (let i = e.resultIndex; i < e.results.length; ++i) if (e.results[i].isFinal) t += e.results[i][0].transcript;
            if (activeSide && t) document.getElementById(activeSide + '-buffer').innerText += t;
        };

        async function send(side) {
            const buf = document.getElementById(side + '-buffer');
            const text = buf.innerText.trim(); if (!text) return;
            const other = side === 'top' ? 'bottom' : 'top';
            const target = document.getElementById(other + '-lang').value;
            try {
                const res = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${target.split('-')[0]}&dt=t&q=${encodeURI(text)}`);
                const data = await res.json();
                const result = data[0][0][0];
                document.getElementById(other + '-display').innerText = result;
                document.getElementById(other + '-half').classList.add('has-msg');
                if (!muteState[other]) { const u = new SpeechSynthesisUtterance(result); u.lang = target; u.rate = 0.9; synth.speak(u); }
                buf.innerText = "";
            } catch (e) {}
        }

        function toggleMute(s) { muteState[s] = !muteState[s]; document.getElementById(s+'-mute').innerText = muteState[s] ? 'üîá' : 'üîä'; document.getElementById(s+'-mute').classList.toggle('active'); }
        function clearBuf(s) { document.getElementById(s + '-buffer').innerText = ""; }
        function clearMsg(s) { const h = document.getElementById(s + '-half'); if (h.classList.contains('has-msg')) { h.classList.remove('has-msg'); document.getElementById(s + '-display').innerText = ""; synth.cancel(); } }

        init();
    </script>
</body>
</html>